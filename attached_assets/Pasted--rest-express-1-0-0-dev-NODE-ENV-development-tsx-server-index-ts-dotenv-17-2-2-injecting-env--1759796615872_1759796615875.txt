
> rest-express@1.0.0 dev
> NODE_ENV=development tsx server/index.ts

[dotenv@17.2.2] injecting env (0) from .env -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
Using database: Primary
11:59:05 PM [express] serving on port 5000
Browserslist: browsers data (caniuse-lite) is 12 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
11:59:13 PM [express] GET /api/user 401 in 3ms
11:59:19 PM [express] POST /api/login 200 in 206ms :: {"id":"5de9729e-14d1-4803-9989-9f5d3d8c7815","u‚Ä¶
11:59:19 PM [express] GET /api/user/notifications 304 in 137ms :: [{"id":"8573b261-5a64-4eec-bfa8-d06‚Ä¶
11:59:19 PM [express] GET /api/freemium/next 304 in 132ms :: {"nextClaimTime":0}
11:59:19 PM [express] GET /api/leaderboard 304 in 329ms :: [{"username":"deez","coins":999959258,"lev‚Ä¶
11:59:19 PM [express] GET /api/user/transactions 304 in 334ms :: [{"id":"b747d927-bc7d-4e55-959b-7721‚Ä¶
11:59:21 PM [express] GET /api/user 304 in 67ms :: {"id":"5de9729e-14d1-4803-9989-9f5d3d8c7815","user‚Ä¶
11:59:22 PM [express] GET /api/admin/users 403 in 68ms :: {"error":"Admin authentication required"}
11:59:26 PM [express] POST /api/admin/authenticate 200 in 134ms :: {"success":true,"message":"Admin a‚Ä¶
11:59:26 PM [express] GET /api/admin/notifications/presets 304 in 67ms :: [{"id":"maintenance","title‚Ä¶
11:59:26 PM [express] GET /api/admin/events/presets 200 in 70ms :: [{"id":"double_xp_weekend","name":‚Ä¶
11:59:26 PM [express] GET /api/friday-boost/status 304 in 66ms :: {"active":false,"boosts":{"gambling‚Ä¶
11:59:26 PM [express] GET /api/admin/users 200 in 199ms :: [{"id":"1b6f2a57-0e19-495e-81bf-ec479b7f83‚Ä¶
11:59:26 PM [express] GET /api/admin/feature-flags 304 in 132ms :: [{"id":"c78c5a5e-c795-461c-8ba6-27‚Ä¶
11:59:26 PM [express] GET /api/admin/items 200 in 332ms :: [{"id":"ce4904d0-0b88-4461-8f04-63ddb0dbe6‚Ä¶
11:59:26 PM [express] GET /api/admin/analytics 200 in 264ms :: {"users":{"total":12,"active":10,"bann‚Ä¶
11:59:26 PM [express] GET /api/admin/events 304 in 330ms :: []
11:59:27 PM [express] GET /api/admin/transactions 304 in 997ms :: [{"id":"b747d927-bc7d-4e55-959b-772‚Ä¶
12:00:26 AM [express] GET /api/friday-boost/status 304 in 277ms :: {"active":false,"boosts":{"gamblin‚Ä¶
Failed to log admin action: TypeError: Cannot read properties of undefined (reading 'ip')
    at logAdminAction (/home/runner/workspace/server/auth.ts:32:21)
    at <anonymous> (/home/runner/workspace/server/routes.ts:2465:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
12:00:58 AM [express] POST /api/admin/notifications/global 200 in 1060ms :: {"success":true,"message"‚Ä¶
12:17:30 AM [express] GET /api/friday-boost/status 304 in 757ms :: {"active":false,"boosts":{"gamblin‚Ä¶
file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:395
0&&(o=t[0]),o instanceof Error)throw o;var u=new Error("Unhandled error."+(o?" ("+
                               ^

Error: Connection terminated unexpectedly
    at fn.<anonymous> (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1250:44)
    at Object.onceWrapper (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:410:15)
    at fn.emit (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:397:12)
    at v.<anonymous> (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1202:66)
    at v.emit (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:397:12)
    at WebSocket.<anonymous> (file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:988:51)
    at callListener (/home/runner/workspace/node_modules/ws/lib/event-target.js:290:14)
    at WebSocket.onClose (/home/runner/workspace/node_modules/ws/lib/event-target.js:220:9)
    at WebSocket.emit (node:events:524:28)
    at WebSocket.emitClose (/home/runner/workspace/node_modules/ws/lib/websocket.js:272:10)
    at TLSSocket.socketOnClose (/home/runner/workspace/node_modules/ws/lib/websocket.js:1341:15)
    at TLSSocket.emit (node:events:536:35)
    at node:net:343:12
    at TCP.done (node:_tls_wrap:648:7) {
  client: NeonClient {
    _events: [Object: null prototype] { error: [Function (anonymous)] },
    _eventsCount: 1,
    _maxListeners: undefined,
    connectionParameters: ConnectionParameters {
      user: 'neondb_owner',
      database: 'neondb',
      port: 5432,
      host: 'ep-divine-union-ad7leysz-pooler.c-2.us-east-1.aws.neon.tech',
      binary: false,
      options: undefined,
      ssl: {},
      client_encoding: '',
      replication: undefined,
      isDomainSocket: false,
      application_name: undefined,
      fallback_application_name: undefined,
      statement_timeout: false,
      lock_timeout: false,
      idle_in_transaction_session_timeout: false,
      query_timeout: false,
      connect_timeout: 0
    },
    user: 'neondb_owner',
    database: 'neondb',
    port: 5432,
    host: 'ep-divine-union-ad7leysz-pooler.c-2.us-east-1.aws.neon.tech',
    replication: undefined,
    _Promise: [Function: Promise],
    _types: TypeOverrides {
      _types: {
        getTypeParser: [Function: getTypeParser],
        setTypeParser: [Function: setTypeParser],
        arrayParser: { create: [Function: create] },
        builtins: {
          BOOL: 16,
          BYTEA: 17,
          CHAR: 18,
          INT8: 20,
          INT2: 21,
          INT4: 23,
          REGPROC: 24,
          TEXT: 25,
          OID: 26,
          TID: 27,
          XID: 28,
          CID: 29,
          JSON: 114,
          XML: 142,
          PG_NODE_TREE: 194,
          SMGR: 210,
          PATH: 602,
          POLYGON: 604,
          CIDR: 650,
          FLOAT4: 700,
          FLOAT8: 701,
          ABSTIME: 702,
          RELTIME: 703,
          TINTERVAL: 704,
          CIRCLE: 718,
          MACADDR8: 774,
          MONEY: 790,
          MACADDR: 829,
          INET: 869,
          ACLITEM: 1033,
          BPCHAR: 1042,
          VARCHAR: 1043,
          DATE: 1082,
          TIME: 1083,
          TIMESTAMP: 1114,
          TIMESTAMPTZ: 1184,
          INTERVAL: 1186,
          TIMETZ: 1266,
          BIT: 1560,
          VARBIT: 1562,
          NUMERIC: 1700,
          REFCURSOR: 1790,
          REGPROCEDURE: 2202,
          REGOPER: 2203,
          REGOPERATOR: 2204,
          REGCLASS: 2205,
          REGTYPE: 2206,
          UUID: 2950,
          TXID_SNAPSHOT: 2970,
          PG_LSN: 3220,
          PG_NDISTINCT: 3361,
          PG_DEPENDENCIES: 3402,
          TSVECTOR: 3614,
          TSQUERY: 3615,
          GTSVECTOR: 3642,
          REGCONFIG: 3734,
          REGDICTIONARY: 3769,
          JSONB: 3802,
          REGNAMESPACE: 4089,
          REGROLE: 4096
        }
      },
      text: {},
      binary: {}
    },
    _ending: true,
    _connecting: false,
    _connected: true,
    _connectionError: false,
    _queryable: false,
    connection: Connection {
      _events: [Object: null prototype] {
        newListener: [Function (anonymous)],
        connect: [ [Function (anonymous)], [Function (anonymous)] ],
        sslconnect: [Function (anonymous)],
        authenticationMD5Password: [Function: bound _handleAuthMD5Password],
        authenticationSASL: [Function: bound _handleAuthSASL],
        authenticationSASLContinue: [Function: bound _handleAuthSASLContinue] AsyncFunction,
        authenticationSASLFinal: [Function: bound _handleAuthSASLFinal],
        backendKeyData: [Function: bound _handleBackendKeyData],
        error: [Function: bound _handleErrorEvent],
        errorMessage: [Function: bound _handleErrorMessage],
        notice: [Function: bound _handleNotice],
        rowDescription: [Function: bound _handleRowDescription],
        dataRow: [Function: bound _handleDataRow],
        portalSuspended: [Function: bound _handlePortalSuspended],
        emptyQuery: [Function: bound _handleEmptyQuery],
        commandComplete: [Function: bound _handleCommandComplete],
        parseComplete: [Function: bound _handleParseComplete],
        copyInResponse: [Function: bound _handleCopyInResponse],
        copyData: [Function: bound _handleCopyData],
        notification: [Function: bound _handleNotification],
        readyForQuery: [Function: bound _handleReadyForQuery],
        end: [Function: bound onceWrapper] {
          listener: [Function (anonymous)]
        }
      },
      _eventsCount: 22,
      _maxListeners: undefined,
      stream: Socket {
        _events: [Object: null prototype] {
          error: [Function: reportStreamError],
          close: [Function (anonymous)],
          end: [ [Function (anonymous)], [Function (anonymous)] ],
          data: [Function (anonymous)]
        },
        _eventsCount: 4,
        _maxListeners: undefined,
        opts: {},
        connecting: false,
        pending: false,
        writable: true,
        encrypted: false,
        authorized: false,
        destroyed: true,
        ws: <ref *1> WebSocket {
          _events: [Object: null prototype] {
            error: [Function],
            message: [Function],
            close: [Function],
            open: [Function]
          },
          _eventsCount: 4,
          _maxListeners: undefined,
          _binaryType: 'arraybuffer',
          _closeCode: 1000,
          _closeFrameReceived: true,
          _closeFrameSent: true,
          _closeMessage: Buffer(0) [Uint8Array] [],
          _closeTimer: Timeout {
            _idleTimeout: -1,
            _idlePrev: null,
            _idleNext: null,
            _idleStart: 1433435,
            _onTimeout: null,
            _timerArgs: undefined,
            _repeat: null,
            _destroyed: true,
            [Symbol(refed)]: true,
            [Symbol(kHasPrimitive)]: false,
            [Symbol(asyncId)]: 9154,
            [Symbol(triggerId)]: 9068
          },
          _errorEmitted: false,
          _extensions: {},
          _paused: false,
          _protocol: '',
          _readyState: 3,
          _receiver: Receiver {
            _events: [Object: null prototype] {},
            _writableState: [WritableState],
            _maxListeners: undefined,
            _allowSynchronousEvents: true,
            _binaryType: 'arraybuffer',
            _extensions: {},
            _isServer: false,
            _maxPayload: 104857600,
            _skipUTF8Validation: false,
            _bufferedBytes: 0,
            _buffers: [],
            _compressed: false,
            _payloadLength: 2,
            _mask: undefined,
            _fragmented: 0,
            _masked: false,
            _fin: true,
            _opcode: 8,
            _totalPayloadLength: 0,
            _messageLength: 0,
            _fragments: [],
            _errored: false,
            _loop: false,
            _state: 0,
            _eventsCount: 0,
            [Symbol(shapeMode)]: false,
            [Symbol(kCapture)]: false,
            [Symbol(websocket)]: [Circular *1]
          },
          _sender: Sender {
            _extensions: {},
            _socket: [TLSSocket],
            _firstFragment: true,
            _compress: false,
            _bufferedBytes: 0,
            _queue: [],
            _state: 0,
            onerror: [Function: senderOnError],
            [Symbol(websocket)]: [Circular *1]
          },
          _socket: TLSSocket {
            _tlsOptions: [Object],
            _secureEstablished: true,
            _securePending: false,
            _newSessionPending: false,
            _controlReleased: true,
            secureConnecting: false,
            _SNICallback: null,
            servername: 'ep-divine-union-ad7leysz-pooler.c-2.us-east-1.aws.neon.tech',
            alpnProtocol: false,
            authorized: true,
            authorizationError: null,
            encrypted: true,
            _events: [Object: null prototype],
            _eventsCount: 5,
            connecting: false,
            _hadError: false,
            _parent: null,
            _host: 'ep-divine-union-ad7leysz-pooler.c-2.us-east-1.aws.neon.tech',
            _closeAfterHandlingError: false,
            _readableState: [ReadableState],
            _writableState: [WritableState],
            allowHalfOpen: false,
            _maxListeners: undefined,
            _sockname: null,
            _pendingData: null,
            _pendingEncoding: '',
            server: undefined,
            _server: null,
            ssl: null,
            _requestCert: true,
            _rejectUnauthorized: true,
            parser: null,
            _httpMessage: null,
            autoSelectFamilyAttemptedAddresses: [Array],
            timeout: 0,
            write: [Function: writeAfterFIN],
            [Symbol(alpncallback)]: null,
            [Symbol(res)]: null,
            [Symbol(verified)]: true,
            [Symbol(pendingSession)]: null,
            [Symbol(async_id_symbol)]: 9068,
            [Symbol(kHandle)]: null,
            [Symbol(lastWriteQueueSize)]: 0,
            [Symbol(timeout)]: null,
            [Symbol(kBuffer)]: null,
            [Symbol(kBufferCb)]: null,
            [Symbol(kBufferGen)]: null,
            [Symbol(shapeMode)]: true,
            [Symbol(kCapture)]: false,
            [Symbol(kSetNoDelay)]: true,
            [Symbol(kSetKeepAlive)]: false,
            [Symbol(kSetKeepAliveInitialDelay)]: 0,
            [Symbol(kBytesRead)]: 4430,
            [Symbol(kBytesWritten)]: 1802,
            [Symbol(connect-options)]: [Object],
            [Symbol(websocket)]: undefined
          },
          _bufferedAmount: 0,
          _isServer: false,
          _redirects: 0,
          _autoPong: true,
          _url: 'wss://ep-divine-union-ad7leysz-pooler.c-2.us-east-1.aws.neon.tech/v2',
          _req: null,
          [Symbol(shapeMode)]: false,
          [Symbol(kCapture)]: false
        },
        writeBuffer: undefined,
        tlsState: 0,
        tlsRead: undefined,
        tlsWrite: undefined
      },
      _keepAlive: false,
      _keepAliveInitialDelayMillis: 0,
      lastBuffer: false,
      parsedStatements: {},
      ssl: false,
      _ending: true,
      _emitMessage: false,
      _connecting: true
    },
    queryQueue: [],
    binary: false,
    processID: 105258391,
    secretKey: -1021717868,
    ssl: false,
    _connectionTimeoutMillis: 0,
    config: {
      connectionString: 'postgresql://neondb_owner:npg_oYF0DUTeNcp4@ep-divine-union-ad7leysz-pooler.c-2.us-east-1.aws.neon.tech/neondb?sslmode=require',
      max: 10,
      maxUses: Infinity,
      allowExitOnIdle: false,
      maxLifetimeSeconds: 0,
      idleTimeoutMillis: 10000
    },
    _connectionCallback: null,
    release: [Function (anonymous)],
    activeQuery: null,
    readyForQuery: true,
    hasExecuted: true,
    _poolUseCount: 2
  }
}

Node.js v20.19.3
